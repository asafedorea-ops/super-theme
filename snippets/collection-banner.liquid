<!-- start collection-banner.liquid (SNIPPET) -->
{%- assign show_banner = true -%}
{%- assign enabled_remove_feature_image = settings.enabled_collection_featured_image_filter -%}
{%- assign handles_list = settings.collection_featured_image_filter -%}
{%- assign collections_title = handles_list | split: ';' -%}
{%- assign handle_array = '' -%}

{%- for title in collections_title -%}
    {%- assign handled_title = title | handleize -%}
    {%- assign handle_array = handle_array | join: ';' -%}
    {%- assign handle_array = handle_array | append: ';' | append: handled_title -%}
    {%- assign handle_array = handle_array | split: ';' -%}
{%- endfor -%}

{%- if settings.enabled_collection_featured_image and handle_array contains collection.handle and handles_list != blank and enabled_remove_feature_image -%}
    {%- assign show_banner = false -%}
{%- endif -%}

{%- if settings.enabled_collection_featured_image == true and show_banner and collection.image != blank -%}
    <div class="collection-banner">
        <picture>
            {%- assign default_image = collection.image -%}
            {%- assign desktop_widths = '1500,1400,1300,1200,1100,1000,900,800' | split: ',' -%}
            {%- assign mobile_widths = '700,600,500,400' | split: ',' -%}

            {%- assign image_desktop_width = 1440 -%}
            {%- assign image_desktop_height = image_desktop_width | divided_by: default_image.aspect_ratio -%}

            <source class="lazy2 lazy3" media="(min-width: 768px)" {% if enable_lazy %}data-{% endif %}srcset="
            {%- for desktop_width in desktop_widths -%}
                https:{{- default_image | image_url: width: desktop_width }} {{ desktop_width }}w,
            {%- endfor -%}
            "/>

            <source class="lazy2 lazy3" media="(max-width: 767px)" {% if enable_lazy %}data-{% endif %}srcset="
            {%- for mobile_width in mobile_widths -%}
                https:{{- default_image | image_url: width: mobile_width }} {{ mobile_width }}w,
            {%- endfor -%}
            "/>
            <img class="collection-banner__image" width="{{ image_desktop_width }}" height="{{ image_desktop_height }}"  src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=" alt="Banner"/>
        </picture>
    </div>
{%- endif -%}